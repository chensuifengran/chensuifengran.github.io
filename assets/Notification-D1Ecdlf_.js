import{d as Q,ca as ee,cb as te,l as V,c as ae,z as X,X as se,B as ie,C,aa as R,cc as B,cd as r,a5 as oe,a8 as ne,a9 as re,i as d,o as y,a as le,m as N,g as v,w as _,F as ce,b as x,au as ue,u as de,e as pe,Y as we,ce as g,E as me,v as ge,q as fe,T as ye,n as Y,t as A,bw as _e,_ as he}from"./index-waqMAD9w.js";import{w as ve,b as xe,a as Se,_ as ze,c as Me}from"./AlertCircle-DKRzJ4kq.js";const be={class:"notification-content","data-tauri-drag-region":"",style:{cursor:"move"}},Pe={class:"btns"},I=50,n=10,Te=Q({__name:"Notification",setup(We){de(a=>({e63280d0:d(M)}));const i=ee(),S=te(),{borderRadius:z,appOpacity:M,appTransform:k,oppositeBgColor:$}=pe(),{open:D}=ve;let l;const b=V(1),O=ae(()=>{const a=Math.floor(b.value/3600),e=Math.floor(b.value%3600/60),t=Math.floor(b.value%60);return`${a?`${a}:`:""}${e?`${e}:`:""}${t}`}),{notify:P}=we,U=X({info:$?.value,loading:$?.value,success:"#67c23a",warning:"#e6a23c",danger:"#f56c6c"}),c=X({name:"运行中",currentMessage:{type:"info",message:"",time:""}});let T=!1;const q=async()=>{(await B.getByLabel("main"))?.show(),i.hide(),T=!0};let E;const w={lastX:0,lastY:0,lastMirrorPos:""};let u,m;const f=V(!0);se(f,async()=>{if(m&&clearTimeout(m),f.value){if(k.value="none",z.value="20px",await i?.setSize(new r(300,40)),await S?.setSize(new r(300,40)),M.value=1,await R(),w.lastMirrorPos==="right"&&u){const a=await l?.getWindow().outerPosition();await i?.setPosition(new g(u.width-300,a?.y||0))}}else{if(w.lastMirrorPos==="")return;const a=await i.outerPosition(),e=await i.innerSize();w.lastMirrorPos==="left"?(await i?.setPosition(new g(0,a.y)),k.value=`translateX(calc(-100% + ${n}px))`,z.value="0px 10px 10px 0px",m=setTimeout(()=>{i?.setSize(new r(n,e.height)),S?.setSize(new r(n,e.height)),M.value=.5,clearTimeout(m)},1e3)):w.lastMirrorPos==="right"?(await i?.setPosition(new g(u.width-e.width,a.y)),k.value=`translateX(calc(100% - ${n}px))`,z.value="10px 0px 0px 10px",m=setTimeout(async()=>{await i?.setSize(new r(n,e.height)),await S?.setSize(new r(n,e.height)),await i.setPosition(new g(u.width-n,a.y)),M.value=.5,clearTimeout(m)},1e3)):(await i?.setPosition(new g(a.x,0)),k.value=`translateY(calc(-100% + ${n}px))`,z.value="0px 0px 10px 10px",m=setTimeout(async()=>{await i?.setSize(new r(e.width,n)),await S?.setSize(new r(e.width,n)),M.value=.5,clearTimeout(m)},1e3)),await l?.hide()}});const F=async(a,e)=>{const t=a??await i.innerSize(),{x:s,y:o}=e??await i.outerPosition();u=u??await C.getScreenSize();const{width:h}=u;let p="";return o<I?s<I?o<=s?p="top":p="left":h-t.width-s<I?o<=h-t.width-s?p="top":p="right":p="top":s<I?p="left":h-t.width-s<I&&(p="right"),p},H=async(a,e)=>{const{x:t,y:s}=await C.getMousePos();return t>=e.x&&t<=e.x+a.width&&s>=e.y&&s<=e.y+a.height},Z=async(a,e,t)=>{if(!f.value){l?.hide();return}if(a===""){l?.hide();return}a==="top"?(await P.sendCustom({name:"borderRadius",message:"0 0 10px 10px"}),await l?.setSize(new r(e.width,n)),await l?.setPos(new g(t.x,0))):a==="left"?(await P.sendCustom({name:"borderRadius",message:"0px 10px 10px 0px"}),await l?.setSize(new r(n,e.height)),await l?.setPos(new g(0,t.y))):a==="right"&&(await P.sendCustom({name:"borderRadius",message:"10px 0px 0px 10px"}),await l?.setSize(new r(n,e.height)),u||(u=await C.getScreenSize()),await l?.setPos(new g(u.width-n,t.y))),await l?.show()};let L,W;return ie(async()=>{u=await C.getScreenSize(),L=await P.listen(e=>{const{type:t,payload:s}=e.payload;if(t==="message")W&&clearInterval(W),c.currentMessage=s,s.type==="loading"&&(b.value=1,W=setInterval(()=>{b.value+=1},1e3));else if(t==="init")c.name=s.name,T=!1,c.currentMessage={type:"info",message:"",time:""};else if(t==="clear-message")c.currentMessage={type:"info",message:"",time:""};else if(t==="done")c.currentMessage={type:"info",message:"",time:""},i.hide(),T=!0;else if(t==="custom-message"){const{name:o}=s;o==="continue"&&(T=!1)}}),l=await D("floatWindow","/floatWindow",{height:300,width:40,alwaysOnTop:!1}),await P.sendCustom({name:"opacity",message:"0.5"}),R(async()=>{(await B.getByLabel("floatWindow"))?.hide()});const a=setTimeout(async()=>{(await B.getByLabel("floatWindow"))?.hide(),clearTimeout(a)},500);i.setSize(new r(300,40)),S.setSize(new r(300,40)),z.value="20px",E=setInterval(async()=>{if(T||!await i.isVisible())return;const e=await C.getMousePos();if(e.x===w.lastX&&e.y===w.lastY)return;w.lastX=e.x,w.lastY=e.y;const t=await i.innerSize(),s=await i.outerPosition(),o=await F(t,s);w.lastMirrorPos=o,o===""?f.value=!0:!await H(t,s)?f.value=!1:f.value=!0,await Z(o,t,s)},200)}),oe(async()=>{W&&clearInterval(W),E&&clearInterval(E),L(),(await B.getByLabel("floatWindow"))?.hide()}),(a,e)=>{const t=Me,s=xe,o=me,h=Se,p=ze,j=_e,G=ge,J=fe,K=ye;return ne((y(),le("div",be,[N("div",{class:"content","data-tauri-drag-region":"",style:ue([{cursor:"move"},{color:d(U)[d(c).currentMessage.type||"info"]}])},[d(c).currentMessage.type==="loading"?(y(),v(t,{key:0,class:"icon","data-tauri-drag-region":"",style:{cursor:"move"}})):d(c).currentMessage.type==="success"?(y(),v(o,{key:1,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:_(()=>[x(s,{"data-tauri-drag-region":""})]),_:1})):d(c).currentMessage.type==="warning"?(y(),v(o,{key:2,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:_(()=>[x(h,{"data-tauri-drag-region":""})]),_:1})):d(c).currentMessage.type==="danger"?(y(),v(o,{key:3,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:_(()=>[x(p,{"data-tauri-drag-region":""})]),_:1})):(y(),v(j,{key:4,"data-tauri-drag-region":"",class:"icon",size:"small",style:{cursor:"move"}})),d(c).currentMessage.type==="loading"?(y(),v(G,{key:5,class:"icon",size:"small",type:"primary","data-tauri-drag-region":"",style:{cursor:"move"}},{default:_(()=>[Y(A(d(O)),1)]),_:1})):ce("",!0),x(J,{class:"message","data-tauri-drag-region":"",style:{cursor:"move"}},{default:_(()=>[Y(A(d(c).currentMessage.message),1)]),_:1})],4),N("div",Pe,[x(K,{class:"btn",size:"small",onClick:q,circle:""},{default:_(()=>[x(o,null,{default:_(()=>e[0]||(e[0]=[N("span",{"i-mdi-home-export-outline":""},null,-1)])),_:1})]),_:1})])],512)),[[re,d(f)]])}}}),ke=he(Te,[["__scopeId","data-v-d9324e3f"]]);export{ke as default};
