import{d as Q,bj as ee,bk as te,r as V,e as ae,C as X,L as se,g as ie,n as R,W as B,bl as r,h as oe,a9 as ne,aa as re,m as d,o as y,i as le,a as N,c as v,w as h,ab as ce,j as x,ai as ue,u as de,bm as g,E as pe,ac as we,q as me,p as ge,l as A,t as D}from"./.pnpm-D_Vtnb2u.js";import{w as fe,c as ye,b as he,a as _e,_ as ve,d as xe}from"./InfoIcon.vue_vue_type_script_setup_true_lang-DTXQV3Wm.js";import{i as C,u as Se,X as ze,_ as Me}from"./index-BNIoerFH.js";const be={class:"notification-content","data-tauri-drag-region":"",style:{cursor:"move"}},Pe={class:"btns"},k=50,n=10,We=Q({__name:"Notification",setup(Te){de(a=>({"2161aa1e":d(M)}));const i=ee(),S=te(),{borderRadius:z,appOpacity:M,appTransform:I,oppositeBgColor:$}=Se(),{open:O}=fe;let l;const b=V(1),Y=ae(()=>{const a=Math.floor(b.value/3600),e=Math.floor(b.value%3600/60),t=Math.floor(b.value%60);return`${a?`${a}:`:""}${e?`${e}:`:""}${t}`}),{notify:P}=ze,U=X({info:$?.value,loading:$?.value,success:"#67c23a",warning:"#e6a23c",danger:"#f56c6c"}),c=X({name:"运行中",currentMessage:{type:"info",message:"",time:""}});let W=!1;const j=async()=>{(await B.getByLabel("main"))?.show(),i.hide(),W=!0};let E;const w={lastX:0,lastY:0,lastMirrorPos:""};let u,m;const f=V(!0);se(f,async()=>{if(m&&clearTimeout(m),f.value){if(I.value="none",z.value="20px",await i?.setSize(new r(300,40)),await S?.setSize(new r(300,40)),M.value=1,await R(),w.lastMirrorPos==="right"&&u){const a=await l?.getWindow().outerPosition();await i?.setPosition(new g(u.width-300,a?.y||0))}}else{if(w.lastMirrorPos==="")return;const a=await i.outerPosition(),e=await i.innerSize();w.lastMirrorPos==="left"?(await i?.setPosition(new g(0,a.y)),I.value=`translateX(calc(-100% + ${n}px))`,z.value="0px 10px 10px 0px",m=setTimeout(()=>{i?.setSize(new r(n,e.height)),S?.setSize(new r(n,e.height)),M.value=.5,clearTimeout(m)},1e3)):w.lastMirrorPos==="right"?(await i?.setPosition(new g(u.width-e.width,a.y)),I.value=`translateX(calc(100% - ${n}px))`,z.value="10px 0px 0px 10px",m=setTimeout(async()=>{await i?.setSize(new r(n,e.height)),await S?.setSize(new r(n,e.height)),await i.setPosition(new g(u.width-n,a.y)),M.value=.5,clearTimeout(m)},1e3)):(await i?.setPosition(new g(a.x,0)),I.value=`translateY(calc(-100% + ${n}px))`,z.value="0px 0px 10px 10px",m=setTimeout(async()=>{await i?.setSize(new r(e.width,n)),await S?.setSize(new r(e.width,n)),M.value=.5,clearTimeout(m)},1e3)),await l?.hide()}});const q=async(a,e)=>{const t=a??await i.innerSize(),{x:s,y:o}=e??await i.outerPosition();u=u??await C.getScreenSize();const{width:_}=u;let p="";return o<k?s<k?o<=s?p="top":p="left":_-t.width-s<k?o<=_-t.width-s?p="top":p="right":p="top":s<k?p="left":_-t.width-s<k&&(p="right"),p},H=async(a,e)=>{const{x:t,y:s}=await C.getMousePos();return t>=e.x&&t<=e.x+a.width&&s>=e.y&&s<=e.y+a.height},Z=async(a,e,t)=>{if(!f.value){l?.hide();return}if(a===""){l?.hide();return}a==="top"?(await P.sendCustom({name:"borderRadius",message:"0 0 10px 10px"}),await l?.setSize(new r(e.width,n)),await l?.setPos(new g(t.x,0))):a==="left"?(await P.sendCustom({name:"borderRadius",message:"0px 10px 10px 0px"}),await l?.setSize(new r(n,e.height)),await l?.setPos(new g(0,t.y))):a==="right"&&(await P.sendCustom({name:"borderRadius",message:"10px 0px 0px 10px"}),await l?.setSize(new r(n,e.height)),u||(u=await C.getScreenSize()),await l?.setPos(new g(u.width-n,t.y))),await l?.show()};let L,T;return ie(async()=>{u=await C.getScreenSize(),L=await P.listen(e=>{const{type:t,payload:s}=e.payload;if(t==="message")T&&clearInterval(T),c.currentMessage=s,s.type==="loading"&&(b.value=1,T=setInterval(()=>{b.value+=1},1e3));else if(t==="init")c.name=s.name,W=!1,c.currentMessage={type:"info",message:"",time:""};else if(t==="clear-message")c.currentMessage={type:"info",message:"",time:""};else if(t==="done")c.currentMessage={type:"info",message:"",time:""},i.hide(),W=!0;else if(t==="custom-message"){const{name:o}=s;o==="continue"&&(W=!1)}}),l=await O("floatWindow","/floatWindow",{height:300,width:40,alwaysOnTop:!1}),await P.sendCustom({name:"opacity",message:"0.5"}),R(async()=>{(await B.getByLabel("floatWindow"))?.hide()});const a=setTimeout(async()=>{(await B.getByLabel("floatWindow"))?.hide(),clearTimeout(a)},500);i.setSize(new r(300,40)),S.setSize(new r(300,40)),z.value="20px",E=setInterval(async()=>{if(W||!await i.isVisible())return;const e=await C.getMousePos();if(e.x===w.lastX&&e.y===w.lastY)return;w.lastX=e.x,w.lastY=e.y;const t=await i.innerSize(),s=await i.outerPosition(),o=await q(t,s);w.lastMirrorPos=o,o===""?f.value=!0:!await H(t,s)?f.value=!1:f.value=!0,await Z(o,t,s)},200)}),oe(async()=>{T&&clearInterval(T),E&&clearInterval(E),L(),(await B.getByLabel("floatWindow"))?.hide()}),(a,e)=>{const t=ye,s=he,o=pe,_=_e,p=ve,F=xe,G=we,J=me,K=ge;return ne((y(),le("div",be,[N("div",{class:"content","data-tauri-drag-region":"",style:ue([{cursor:"move"},{color:d(U)[d(c).currentMessage.type||"info"]}])},[d(c).currentMessage.type==="loading"?(y(),v(t,{key:0,class:"icon","data-tauri-drag-region":"",style:{cursor:"move"}})):d(c).currentMessage.type==="success"?(y(),v(o,{key:1,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[x(s,{"data-tauri-drag-region":""})]),_:1})):d(c).currentMessage.type==="warning"?(y(),v(o,{key:2,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[x(_,{"data-tauri-drag-region":""})]),_:1})):d(c).currentMessage.type==="danger"?(y(),v(o,{key:3,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[x(p,{"data-tauri-drag-region":""})]),_:1})):(y(),v(F,{key:4,"data-tauri-drag-region":"",class:"icon",size:"small",style:{cursor:"move"}})),d(c).currentMessage.type==="loading"?(y(),v(G,{key:5,class:"icon",size:"small",type:"primary","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[A(D(d(Y)),1)]),_:1})):ce("",!0),x(J,{class:"message","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[A(D(d(c).currentMessage.message),1)]),_:1})],4),N("div",Pe,[x(K,{class:"btn",size:"small",onClick:j,circle:""},{default:h(()=>[x(o,null,{default:h(()=>e[0]||(e[0]=[N("span",{"i-mdi-home-export-outline":""},null,-1)])),_:1})]),_:1})])],512)),[[re,d(f)]])}}}),Be=Me(We,[["__scopeId","data-v-f1874fdf"]]);export{Be as default};
