import{_ as ct}from"./CodeIcon-DI3GK8Zo.js";import{d as tt,u as et,i as o,j as ot,s as st,e as lt,c as C,k as u,l as A,o as L,a as J,m as s,g as z,w as n,b as i,n as g,t as E,p as f,E as vt,q as mt,v as ft,x as gt,_ as nt,y as St,z as _t,A as kt,S as Q,B as yt,C as bt,D as W,F as Ct,G as Lt,H as xt,I as wt,J as It,K as Et,L as Tt,M as Vt,N,O as U,P as Bt,Q as Y,R as Z,T as At,f as Dt}from"./index-waqMAD9w.js";import{E as Rt}from"./el-empty-DKbGgi1T.js";/* empty css                        */import{l as Ft}from"./vue-draggable-plus-yIVIIXiv.js";const Pt={class:"content drag-handle"},ht={class:"info"},Mt={class:"s-name"},Nt={class:"menu"},Ut=tt({__name:"ScriptListItem",props:{id:{type:String,required:!0},showHover:{type:Boolean,default:!0}},emits:["editorScriptFile","openFile","setScript","runScript","deleteScript"],setup(K,{emit:S}){et(v=>({fb6ad67e:o(c),"09614f80":o($),18942100:o(p),"04f8ea28":o(D),aee717dc:o(T)}));const H=ot();st(H);const{appAsideBgColor:$,appBackground:D}=lt(),x=K,T=C(()=>x.showHover?"4px":"0px"),p=C(()=>x.showHover?"all 0.5s":"none"),_=S,w=C(()=>u().mockScriptList.value.find(v=>v.id===x.id)),a=C(()=>u().mockScriptList.value.findIndex(v=>v.id===x.id)),k=A(!1),R=()=>{a.value!==void 0&&a.value!==-1&&_("deleteScript",a.value)},V=()=>{a.value!==void 0&&a.value!==-1&&_("editorScriptFile",a.value)},O=()=>{a.value!==void 0&&a.value!==-1&&_("openFile",a.value)},y=()=>{a.value!==void 0&&a.value!==-1&&_("setScript",a.value)},G=()=>{a.value!==void 0&&a.value!==-1&&_("runScript",a.value)},B=A(),c=C(()=>k.value?40+B.value.clientHeight+"px":"40px");return(v,l)=>{const m=vt,F=mt,q=ft,b=gt,X=ct;return L(),J("div",{class:"script-item",onClick:l[3]||(l[3]=j=>k.value=!o(k))},[s("div",Pt,[s("div",ht,[o(k)?(L(),z(m,{key:1,class:"icon",size:"large"},{default:n(()=>l[5]||(l[5]=[s("div",{"i-solar-alt-arrow-down-line-duotone":""},null,-1)])),_:1})):(L(),z(m,{key:0,class:"icon",size:"large"},{default:n(()=>l[4]||(l[4]=[s("div",{"i-solar-alt-arrow-right-line-duotone":""},null,-1)])),_:1})),i(q,{size:"small",type:"info"},{default:n(()=>[i(F,{class:"v-text",truncated:"",size:"small"},{default:n(()=>[g(E(o(w).version),1)]),_:1})]),_:1}),s("div",Mt,[i(F,{truncated:"",tag:"Bold",size:"large"},{default:n(()=>[g(E(o(w).name),1)]),_:1})])]),s("div",Nt,[i(b,{class:"box-item",effect:"dark",content:"从列表移除",placement:"bottom"},{default:n(()=>[i(m,{class:"icon",onClick:f(R,["stop"])},{default:n(()=>l[6]||(l[6]=[s("span",{"i-mdi-playlist-remove":""},null,-1)])),_:1})]),_:1}),i(b,{class:"box-item",effect:"dark",content:"编辑脚本",placement:"bottom"},{default:n(()=>[i(X,{class:"icon",onClick:f(V,["stop"])})]),_:1}),i(b,{class:"box-item",effect:"dark",content:"打开脚本",placement:"bottom"},{default:n(()=>[i(m,{class:"icon",onClick:f(O,["stop"])},{default:n(()=>l[7]||(l[7]=[s("span",{"i-mdi-folder-eye-outline":""},null,-1)])),_:1})]),_:1}),i(b,{class:"box-item",effect:"dark",content:"脚本设置",placement:"bottom"},{default:n(()=>[i(m,{class:"icon",onClick:f(y,["stop"])},{default:n(()=>l[8]||(l[8]=[s("span",{"i-solar-settings-linear":""},null,-1)])),_:1})]),_:1}),i(b,{class:"box-item",effect:"dark",content:"运行脚本",placement:"bottom"},{default:n(()=>[i(m,{class:"icon",onClick:f(G,["stop"])},{default:n(()=>l[9]||(l[9]=[s("span",{"i-mdi-play-circle-outline":""},null,-1)])),_:1})]),_:1})])]),s("div",{class:"details",ref_key:"detailsRef",ref:B},[l[10]||(l[10]=s("div",null,"脚本ID：",-1)),s("div",{class:"text",onClick:l[0]||(l[0]=f(()=>{},["stop"]))},E(o(w).id),1),l[11]||(l[11]=s("div",null,"保存路径：",-1)),s("div",{class:"text",onClick:l[1]||(l[1]=f(()=>{},["stop"]))},E(o(w).savePath),1),l[12]||(l[12]=s("div",null,"脚本描述(备注)：",-1)),s("div",{class:"description",onClick:l[2]||(l[2]=f(()=>{},["stop"]))},E(o(w).description),1)],512)])}}}),zt=nt(Ut,[["__scopeId","data-v-7307ddf4"]]),Ht={class:"script-list-div"},$t={class:"dialog-footer"},Ot={class:"dialog-footer"},Gt={class:"header-right"},qt={class:"list"},Xt=tt({__name:"ScriptList",setup(K){et(e=>({"266e4fa6":o(O)}));const S=St("headerRef"),H=Vt,$=A();let D=()=>{};const x=ot(),{scriptList:T}=st(x),{openId:p,curScriptDir:_,preloadPath:w,preloadText:a,contentTransform:k,asideBarPos:R}=Dt(),V=A(!0),{appBackground:O}=lt(),y=_t({visible:!1,content:"",newImport:()=>{},updateImport:()=>{}}),G=()=>{V.value=!1},B=()=>{V.value=!0},c=A(!1),v=e=>{D=()=>{u().mockScriptList.value.splice(e,1),N({title:"提示",message:"删除成功",type:"success",position:"bottom-right"}),c.value=!1},c.value=!0},l=e=>{k.value="translateX(-100%)",U.replace("/script/editor");let t=T.value[e]?.id,d="";t=u().mockScriptList.value[e]?.id,d="E:\\playground",t===p.value&&(p.value="-1");const M=setTimeout(async()=>{p.value=t,_.value=d||await Bt.resolve(T.value[e].savePath,"../"),clearTimeout(M)},100);R.value="absolute"},m=async e=>{{N({title:"提示",message:"playground环境不支持打开文件",type:"warning",position:"bottom-right"});return}},F=()=>{{const e=Y(),t="v1."+Math.floor(Math.random()*10);u().mockScriptList.value.push({id:e,savePath:"内部存储",name:e,version:t,description:"playground环境测试脚本",setting:{autoImportLastRunConfig:!0,targetAdbDevice:"",excludeDevice:[],targetApp:"",autoStartTargetApp:!1},content:Z(e,t,"playground环境测试脚本")}),N({title:"提示",message:"创建成功",type:"success",position:"bottom-right"}),p.value=e,U.replace({path:"/script/editor"}),k.value="translateX(-100%)",R.value="absolute";return}},q=async()=>{{const e=Y(),t="v1."+Math.floor(Math.random()*10);u().mockScriptList.value.push({id:e,savePath:"内部存储",name:e,version:t,description:"playground环境测试脚本",setting:{autoImportLastRunConfig:!0,targetAdbDevice:"",excludeDevice:[],targetApp:"",autoStartTargetApp:!1},content:Z(e,t,"playground环境测试脚本")}),N({title:"提示",message:"导入成功",type:"success",position:"bottom-right"});return}},b=async e=>{p.value=u().mockScriptList.value[e].id,U.replace("/script/run")},X=e=>{p.value=u().mockScriptList.value[e].id,U.replace("/script/setting")},{trueSearch:j,searchInfo:I}=Lt(),it=C(()=>j.value!==""),P=C({get:()=>{const e=j.value;return e===""?u().mockScriptList.value:u().mockScriptList.value.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase()))},set:e=>{{u().mockScriptList.value=e;return}}}),at=e=>{e.forEach(t=>{I.show=!t.isIntersecting})};let h;return kt(()=>{I.show=!1,I.target=Q.None,h&&S.value&&h.unobserve(S.value)}),yt(()=>{bt.closeSplashscreen(),h=new IntersectionObserver(at,{}),S.value&&h.observe(S.value),I.target=Q.ScriptList}),(e,t)=>{const d=At,M=xt,rt=wt,ut=It,dt=Rt,pt=zt;return L(),J("div",Ht,[i(M,{modelValue:o(y).visible,"onUpdate:modelValue":t[0]||(t[0]=r=>o(y).visible=r),title:"脚本导入"},{footer:n(()=>[s("span",$t,[i(d,{onClick:o(y).newImport},{default:n(()=>t[5]||(t[5]=[g("作为新脚本导入")])),_:1},8,["onClick"]),i(d,{onClick:o(y).updateImport},{default:n(()=>t[6]||(t[6]=[g("更新同名脚本")])),_:1},8,["onClick"])])]),default:n(()=>[s("div",null,E(o(y).content),1),t[7]||(t[7]=s("div",null,"作为新脚本导入：",-1)),t[8]||(t[8]=s("div",null," 此选项会在脚本列表新增一项脚本，该脚本无法继承同名脚本配置(id不一致) ",-1)),t[9]||(t[9]=s("div",null,"更新同名脚本：",-1)),t[10]||(t[10]=s("div",null," 此选项会将新脚本内容覆盖掉同名脚本，该脚本可以继承同名脚本配置(id一致) ",-1))]),_:1},8,["modelValue"]),i(M,{modelValue:o(c),"onUpdate:modelValue":t[2]||(t[2]=r=>W(c)?c.value=r:null),title:"删除脚本"},{footer:n(()=>[s("span",Ot,[i(d,{onClick:t[1]||(t[1]=r=>c.value=!1)},{default:n(()=>t[11]||(t[11]=[g("取消")])),_:1}),i(d,{type:"danger",onClick:o(D)},{default:n(()=>t[12]||(t[12]=[g("删除")])),_:1},8,["onClick"])])]),default:n(()=>[t[13]||(t[13]=s("div",null,"确定要删除该脚本吗?",-1))]),_:1},8,["modelValue"]),s("div",{class:"header",ref_key:"headerRef",ref:S},[t[16]||(t[16]=s("span",{style:{"font-size":"18px"}},"脚本列表",-1)),s("div",Gt,[i(rt,{class:"input",modelValue:o(I).content,"onUpdate:modelValue":t[3]||(t[3]=r=>o(I).content=r),clearable:"",placeholder:"搜索脚本名称或备注"},null,8,["modelValue"]),i(ut,null,{default:n(()=>[i(d,{onClick:q},{default:n(()=>t[14]||(t[14]=[g("导入")])),_:1}),i(d,{type:"primary",onClick:F},{default:n(()=>t[15]||(t[15]=[g("新建")])),_:1})]),_:1})])],512),s("div",qt,[!o(H)&&o(T).length===0?(L(),z(dt,{key:0,description:"暂无脚本"})):Ct("",!0),i(o(Ft),{ref_key:"el",ref:$,modelValue:o(P),"onUpdate:modelValue":t[4]||(t[4]=r=>W(P)?P.value=r:null),ghostClass:"ghost",class:"draggable-content",disabled:o(it),animation:200,handle:".drag-handle",onStart:G,onUpdate:B,onEnd:B},{default:n(()=>[(L(!0),J(Et,null,Tt(o(P),r=>(L(),z(pt,{key:r.id,id:r.id,onEditorScriptFile:l,"show-hover":o(V),onOpenFile:m,onSetScript:X,onRunScript:b,onDeleteScript:v},null,8,["id","show-hover"]))),128))]),_:1},8,["modelValue","disabled"])])])}}}),Yt=nt(Xt,[["__scopeId","data-v-5642f901"]]);export{Yt as default};
