import{bt as I,bW as L,a8 as g,bX as N,bY as h,bZ as w}from"./index-D_dbWzvW.js";const s="ElInfiniteScroll",A=50,O=200,_=0,C={delay:{type:Number,default:O},distance:{type:Number,default:_},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},p=(t,n)=>Object.entries(C).reduce((o,[e,l])=>{var u,i;const{type:d,default:r}=l,a=t.getAttribute(`infinite-scroll-${e}`);let c=(i=(u=n[a])!=null?u:a)!=null?i:r;return c=c==="false"?!1:c,c=d(c),o[e]=Number.isNaN(c)?r:c,o},{}),S=t=>{const{observer:n}=t[s];n&&(n.disconnect(),delete t[s].observer)},D=(t,n)=>{const{container:o,containerEl:e,instance:l,observer:u,lastScrollTop:i}=t[s],{disabled:d,distance:r}=p(t,l),{clientHeight:a,scrollHeight:c,scrollTop:f}=e,m=f-i;if(t[s].lastScrollTop=f,u||d||m<0)return;let b=!1;if(o===t)b=c-(a+f)<=r;else{const{clientTop:T,scrollHeight:y}=t,H=w(t,e);b=f+a>=H+T+y-r}b&&n.call(l)};function v(t,n){const{containerEl:o,instance:e}=t[s],{disabled:l}=p(t,e);l||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?n.call(e):S(t))}const F={async mounted(t,n){const{instance:o,value:e}=n;I(e)||L(s,"'v-infinite-scroll' binding value must be a function"),await g();const{delay:l,immediate:u}=p(t,o),i=N(t,!0),d=i===window?document.documentElement:i,r=h(D.bind(null,t,e),l);if(i){if(t[s]={instance:o,container:i,containerEl:d,delay:l,cb:e,onScroll:r,lastScrollTop:d.scrollTop},u){const a=new MutationObserver(h(v.bind(null,t,e),A));t[s].observer=a,a.observe(t,{childList:!0,subtree:!0}),v(t,e)}i.addEventListener("scroll",r)}},unmounted(t){if(!t[s])return;const{container:n,onScroll:o}=t[s];n?.removeEventListener("scroll",o),S(t)},async updated(t){if(!t[s])await g();else{const{containerEl:n,cb:o,observer:e}=t[s];n.clientHeight&&e&&v(t,o)}}},E=F;E.install=t=>{t.directive("InfiniteScroll",E)};const k=E;export{k as E};
