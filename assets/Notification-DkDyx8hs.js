import{d as Q,cn as ee,co as te,m as V,c as ae,C as R,a1 as se,F as ie,G as C,H as X,cp as B,cq as r,a8 as oe,ab as ne,ac as re,g as d,o as y,a as le,n as N,e as v,w as h,J as ce,b as x,ar as ue,u as de,h as pe,ck as we,cr as g,v as me,y as ge,x as fe,Z as ye,p as A,t as D,_ as he}from"./index-DZzuFKiJ.js";import{w as _e,c as ve,b as xe,a as Se,_ as ze,d as Me}from"./InfoIcon.vue_vue_type_script_setup_true_lang-BqefoTtu.js";const Pe={class:"notification-content","data-tauri-drag-region":"",style:{cursor:"move"}},be={class:"btns"},k=50,n=10,Te=Q({__name:"Notification",setup(We){de(a=>({"2161aa1e":d(M)}));const i=ee(),S=te(),{borderRadius:z,appOpacity:M,appTransform:I,oppositeBgColor:$}=pe(),{open:O}=_e;let l;const P=V(1),Y=ae(()=>{const a=Math.floor(P.value/3600),e=Math.floor(P.value%3600/60),t=Math.floor(P.value%60);return`${a?`${a}:`:""}${e?`${e}:`:""}${t}`}),{notify:b}=we,U=R({info:$?.value,loading:$?.value,success:"#67c23a",warning:"#e6a23c",danger:"#f56c6c"}),c=R({name:"运行中",currentMessage:{type:"info",message:"",time:""}});let T=!1;const H=async()=>{(await B.getByLabel("main"))?.show(),i.hide(),T=!0};let E;const w={lastX:0,lastY:0,lastMirrorPos:""};let u,m;const f=V(!0);se(f,async()=>{if(m&&clearTimeout(m),f.value){if(I.value="none",z.value="20px",await i?.setSize(new r(300,40)),await S?.setSize(new r(300,40)),M.value=1,await X(),w.lastMirrorPos==="right"&&u){const a=await l?.getWindow().outerPosition();await i?.setPosition(new g(u.width-300,a?.y||0))}}else{if(w.lastMirrorPos==="")return;const a=await i.outerPosition(),e=await i.innerSize();w.lastMirrorPos==="left"?(await i?.setPosition(new g(0,a.y)),I.value=`translateX(calc(-100% + ${n}px))`,z.value="0px 10px 10px 0px",m=setTimeout(()=>{i?.setSize(new r(n,e.height)),S?.setSize(new r(n,e.height)),M.value=.5,clearTimeout(m)},1e3)):w.lastMirrorPos==="right"?(await i?.setPosition(new g(u.width-e.width,a.y)),I.value=`translateX(calc(100% - ${n}px))`,z.value="10px 0px 0px 10px",m=setTimeout(async()=>{await i?.setSize(new r(n,e.height)),await S?.setSize(new r(n,e.height)),await i.setPosition(new g(u.width-n,a.y)),M.value=.5,clearTimeout(m)},1e3)):(await i?.setPosition(new g(a.x,0)),I.value=`translateY(calc(-100% + ${n}px))`,z.value="0px 0px 10px 10px",m=setTimeout(async()=>{await i?.setSize(new r(e.width,n)),await S?.setSize(new r(e.width,n)),M.value=.5,clearTimeout(m)},1e3)),await l?.hide()}});const Z=async(a,e)=>{const t=a??await i.innerSize(),{x:s,y:o}=e??await i.outerPosition();u=u??await C.getScreenSize();const{width:_}=u;let p="";return o<k?s<k?o<=s?p="top":p="left":_-t.width-s<k?o<=_-t.width-s?p="top":p="right":p="top":s<k?p="left":_-t.width-s<k&&(p="right"),p},q=async(a,e)=>{const{x:t,y:s}=await C.getMousePos();return t>=e.x&&t<=e.x+a.width&&s>=e.y&&s<=e.y+a.height},F=async(a,e,t)=>{if(!f.value){l?.hide();return}if(a===""){l?.hide();return}a==="top"?(await b.sendCustom({name:"borderRadius",message:"0 0 10px 10px"}),await l?.setSize(new r(e.width,n)),await l?.setPos(new g(t.x,0))):a==="left"?(await b.sendCustom({name:"borderRadius",message:"0px 10px 10px 0px"}),await l?.setSize(new r(n,e.height)),await l?.setPos(new g(0,t.y))):a==="right"&&(await b.sendCustom({name:"borderRadius",message:"10px 0px 0px 10px"}),await l?.setSize(new r(n,e.height)),u||(u=await C.getScreenSize()),await l?.setPos(new g(u.width-n,t.y))),await l?.show()};let L,W;return ie(async()=>{u=await C.getScreenSize(),L=await b.listen(e=>{const{type:t,payload:s}=e.payload;if(t==="message")W&&clearInterval(W),c.currentMessage=s,s.type==="loading"&&(P.value=1,W=setInterval(()=>{P.value+=1},1e3));else if(t==="init")c.name=s.name,T=!1,c.currentMessage={type:"info",message:"",time:""};else if(t==="clear-message")c.currentMessage={type:"info",message:"",time:""};else if(t==="done")c.currentMessage={type:"info",message:"",time:""},i.hide(),T=!0;else if(t==="custom-message"){const{name:o}=s;o==="continue"&&(T=!1)}}),l=await O("floatWindow","/floatWindow",{height:300,width:40,alwaysOnTop:!1}),await b.sendCustom({name:"opacity",message:"0.5"}),X(async()=>{(await B.getByLabel("floatWindow"))?.hide()});const a=setTimeout(async()=>{(await B.getByLabel("floatWindow"))?.hide(),clearTimeout(a)},500);i.setSize(new r(300,40)),S.setSize(new r(300,40)),z.value="20px",E=setInterval(async()=>{if(T||!await i.isVisible())return;const e=await C.getMousePos();if(e.x===w.lastX&&e.y===w.lastY)return;w.lastX=e.x,w.lastY=e.y;const t=await i.innerSize(),s=await i.outerPosition(),o=await Z(t,s);w.lastMirrorPos=o,o===""?f.value=!0:!await q(t,s)?f.value=!1:f.value=!0,await F(o,t,s)},200)}),oe(async()=>{W&&clearInterval(W),E&&clearInterval(E),L(),(await B.getByLabel("floatWindow"))?.hide()}),(a,e)=>{const t=ve,s=xe,o=me,_=Se,p=ze,G=Me,J=ge,j=fe,K=ye;return ne((y(),le("div",Pe,[N("div",{class:"content","data-tauri-drag-region":"",style:ue([{cursor:"move"},{color:d(U)[d(c).currentMessage.type||"info"]}])},[d(c).currentMessage.type==="loading"?(y(),v(t,{key:0,class:"icon","data-tauri-drag-region":"",style:{cursor:"move"}})):d(c).currentMessage.type==="success"?(y(),v(o,{key:1,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[x(s,{"data-tauri-drag-region":""})]),_:1})):d(c).currentMessage.type==="warning"?(y(),v(o,{key:2,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[x(_,{"data-tauri-drag-region":""})]),_:1})):d(c).currentMessage.type==="danger"?(y(),v(o,{key:3,class:"icon",size:"small","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[x(p,{"data-tauri-drag-region":""})]),_:1})):(y(),v(G,{key:4,"data-tauri-drag-region":"",class:"icon",size:"small",style:{cursor:"move"}})),d(c).currentMessage.type==="loading"?(y(),v(J,{key:5,class:"icon",size:"small",type:"primary","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[A(D(d(Y)),1)]),_:1})):ce("",!0),x(j,{class:"message","data-tauri-drag-region":"",style:{cursor:"move"}},{default:h(()=>[A(D(d(c).currentMessage.message),1)]),_:1})],4),N("div",be,[x(K,{class:"btn",size:"small",onClick:H,circle:""},{default:h(()=>[x(o,null,{default:h(()=>e[0]||(e[0]=[N("span",{"i-mdi-home-export-outline":""},null,-1)])),_:1})]),_:1})])],512)),[[re,d(f)]])}}}),Ie=he(Te,[["__scopeId","data-v-f1874fdf"]]);export{Ie as default};
