import{_ as mt}from"./CodeIcon-Da24qVRS.js";import{d as st,u as ot,g as s,k as it,s as nt,h as lt,c as x,l as c,m as h,o as E,a as j,n as o,e as H,w as n,b as l,p as _,t as R,q as S,E as V,v as gt,x as St,y as _t,z as kt,A as at,_ as rt,B as Lt,C as bt,D as yt,S as Q,F as Ct,G as It,H as wt,I as Z,J as xt,K as $,j as Et,L as Tt,M as Dt,N as Rt,O as At,P as Vt,Q as ht,R as Pt,i as Bt,T as z,U as Mt,V as Nt,W as Ft,X as tt,Y as et,Z as Ut}from"./index-DZzuFKiJ.js";import{E as Ot}from"./el-empty-DnTRWnNF.js";/* empty css                        */import{l as $t}from"./vue-draggable-plus-CQmBj7Zm.js";const zt=["id"],Ht={class:"content drag-handle"},Gt={class:"info"},Xt={class:"s-name"},qt={class:"menu"},Wt=st({__name:"ScriptListItem",props:{id:{type:String,required:!0},showHover:{type:Boolean,default:!0}},emits:["editorScriptFile","openFile","setScript","runScript","deleteScript"],setup(J,{emit:k}){ot(m=>({bb7baf36:s(Y),"2df66b1c":s(X),"245a3adc":s(f),"10bf0404":s(P),"6a708694":s(T)}));const G=it();nt(G);const{appAsideBgColor:X,appBackground:P}=lt(),d=J,T=x(()=>d.showHover?"4px":"0px"),f=x(()=>d.showHover?"all 0.5s":"none"),L=k,D=x(()=>c().mockScriptList.value.find(m=>m.id===d.id)),a=x(()=>c().mockScriptList.value.findIndex(m=>m.id===d.id)),{tourInfo:u}=at(),b=h(!1),A=()=>{if(u.scriptList.touring&&u.scriptList.step>=3){V.warning("请先完成引导");return}a.value!==void 0&&a.value!==-1&&L("deleteScript",a.value)},q=()=>{if(u.scriptList.touring&&u.scriptList.step>=3){V.warning("请先完成引导");return}a.value!==void 0&&a.value!==-1&&L("editorScriptFile",a.value)},y=()=>{if(u.scriptList.touring&&u.scriptList.step>=3){V.warning("请先完成引导");return}a.value!==void 0&&a.value!==-1&&L("openFile",a.value)},W=()=>{if(u.scriptList.touring&&u.scriptList.step>=3){V.warning("请先完成引导");return}a.value!==void 0&&a.value!==-1&&L("setScript",a.value)},B=()=>{if(u.scriptList.touring&&u.scriptList.step>=3){V.warning("请先完成引导");return}a.value!==void 0&&a.value!==-1&&L("runScript",a.value)},v=h(),Y=x(()=>b.value?40+v.value.clientHeight+"px":"40px");return(m,i)=>{const g=gt,M=St,N=_t,C=kt,F=mt;return E(),j("div",{class:"script-item",id:d.id,onClick:i[3]||(i[3]=I=>b.value=!s(b))},[o("div",Ht,[o("div",Gt,[s(b)?(E(),H(g,{key:1,class:"icon",size:"large"},{default:n(()=>i[5]||(i[5]=[o("div",{"i-solar-alt-arrow-down-line-duotone":""},null,-1)])),_:1})):(E(),H(g,{key:0,class:"icon",size:"large"},{default:n(()=>i[4]||(i[4]=[o("div",{"i-solar-alt-arrow-right-line-duotone":""},null,-1)])),_:1})),l(N,{size:"small",type:"info"},{default:n(()=>[l(M,{class:"v-text",truncated:"",size:"small"},{default:n(()=>[_(R(s(D).version),1)]),_:1})]),_:1}),o("div",Xt,[l(M,{truncated:"",tag:"Bold",size:"large"},{default:n(()=>[_(R(s(D).name),1)]),_:1})])]),o("div",qt,[l(C,{class:"box-item",effect:"dark",content:"从列表移除",placement:"bottom"},{default:n(()=>[l(g,{id:d.id+"-DEL",class:"icon",onClick:S(A,["stop"])},{default:n(()=>i[6]||(i[6]=[o("span",{"i-mdi-playlist-remove":""},null,-1)])),_:1},8,["id"])]),_:1}),l(C,{class:"box-item",effect:"dark",content:"编辑脚本",placement:"bottom"},{default:n(()=>[l(F,{id:d.id+"-EDIT",class:"icon",onClick:S(q,["stop"])},null,8,["id"])]),_:1}),l(C,{class:"box-item",effect:"dark",content:"打开脚本",placement:"bottom"},{default:n(()=>[l(g,{id:d.id+"-OPEN",class:"icon",onClick:S(y,["stop"])},{default:n(()=>i[7]||(i[7]=[o("span",{"i-mdi-folder-eye-outline":""},null,-1)])),_:1},8,["id"])]),_:1}),l(C,{class:"box-item",effect:"dark",content:"脚本设置",placement:"bottom"},{default:n(()=>[l(g,{id:d.id+"-SETTING",class:"icon",onClick:S(W,["stop"])},{default:n(()=>i[8]||(i[8]=[o("span",{"i-solar-settings-linear":""},null,-1)])),_:1},8,["id"])]),_:1}),l(C,{class:"box-item",effect:"dark",content:"运行脚本",placement:"bottom"},{default:n(()=>[l(g,{id:d.id+"-RUN",class:"icon",onClick:S(B,["stop"])},{default:n(()=>i[9]||(i[9]=[o("span",{"i-mdi-play-circle-outline":""},null,-1)])),_:1},8,["id"])]),_:1})])]),o("div",{class:"details",ref_key:"detailsRef",ref:v},[i[10]||(i[10]=o("div",null,"脚本ID：",-1)),o("div",{class:"text",onClick:i[0]||(i[0]=S(()=>{},["stop"]))},R(s(D).id),1),i[11]||(i[11]=o("div",null,"保存路径：",-1)),o("div",{class:"text",onClick:i[1]||(i[1]=S(()=>{},["stop"]))},R(s(D).savePath),1),i[12]||(i[12]=o("div",null,"脚本描述(备注)：",-1)),o("div",{class:"description",onClick:i[2]||(i[2]=S(()=>{},["stop"]))},R(s(D).description),1)],512)],8,zt)}}}),Yt=rt(Wt,[["__scopeId","data-v-0fc5226c"]]),jt={class:"script-list-div"},Jt={class:"dialog-footer"},Kt={class:"dialog-footer"},Qt={class:"header-right"},Zt={class:"list"},te=st({__name:"ScriptList",setup(J){ot(e=>({"1f8c2a0e":s(q)}));const k=Lt("headerRef"),G=Pt,X=h();let P=()=>{};const d=it(),{scriptList:T}=nt(d),{openId:f,curScriptDir:L,preloadPath:D,preloadText:a,contentTransform:u,asideBarPos:b}=Bt(),A=h(!0),{appBackground:q}=lt(),y=bt({visible:!1,content:"",newImport:()=>{},updateImport:()=>{}}),W=()=>{A.value=!1},B=()=>{A.value=!0},v=h(!1),Y=e=>{P=()=>{c().mockScriptList.value.splice(e,1),z({title:"提示",message:"删除成功",type:"success",position:"bottom-right"}),v.value=!1},v.value=!0},m=e=>{u.value="translateX(-100%)",$.replace("/script/editor");let t=T.value[e]?.id,r="";t=c().mockScriptList.value[e]?.id,r="E:\\playground",t===f.value&&(f.value="-1");const w=setTimeout(async()=>{f.value=t,L.value=r||await Mt.resolve(T.value[e].savePath,"../"),clearTimeout(w)},100);b.value="absolute"},i=async e=>{{z({title:"提示",message:"playground环境不支持打开文件",type:"warning",position:"bottom-right"});return}},g=()=>{const{tourInfo:e}=at();{const{mockScriptList:t}=c();if(e.scriptList.touring&&e.scriptList.step===2){t.value.push({id:Nt,name:"演示脚本",savePath:"内部存储",version:"v1.2",description:"对脚本交互表单的渲染效果进行展示",setting:{autoImportLastRunConfig:!0,targetAdbDevice:"",targetApp:"",autoStartTargetApp:!1,excludeDevice:[]},content:Ft}),e.scriptList.preventNext=!1,e.scriptList.doneSteps.includes(e.scriptList.step)||e.scriptList.doneSteps.push(e.scriptList.step),e.scriptList.step++;return}const r=tt(),w="v1."+Math.floor(Math.random()*10);t.value.push({id:r,savePath:"内部存储",name:r,version:w,description:"playground环境测试脚本",setting:{autoImportLastRunConfig:!0,targetAdbDevice:"",excludeDevice:[],targetApp:"",autoStartTargetApp:!1},content:et(r,w,"playground环境测试脚本")}),z({title:"提示",message:"创建成功",type:"success",position:"bottom-right"}),f.value=r,$.replace({path:"/script/editor"}),u.value="translateX(-100%)",b.value="absolute";return}},M=async()=>{{const e=tt(),t="v1."+Math.floor(Math.random()*10);c().mockScriptList.value.push({id:e,savePath:"内部存储",name:e,version:t,description:"playground环境测试脚本",setting:{autoImportLastRunConfig:!0,targetAdbDevice:"",excludeDevice:[],targetApp:"",autoStartTargetApp:!1},content:et(e,t,"playground环境测试脚本")}),z({title:"提示",message:"导入成功",type:"success",position:"bottom-right"});return}},N=async e=>{f.value=c().mockScriptList.value[e].id,$.replace("/script/run")},C=e=>{f.value=c().mockScriptList.value[e].id,$.replace("/script/setting")},{trueSearch:F,searchInfo:I,ingoreObserver:K}=Et(),ut=x(()=>F.value!==""),U=x({get:()=>{const e=F.value;return e===""?c().mockScriptList.value:c().mockScriptList.value.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase()))},set:e=>{{c().mockScriptList.value=e;return}}}),dt=e=>{e.forEach(t=>{K.value||(I.show=!t.isIntersecting)})};let O;return yt(()=>{K.value=!0,I.show=!1,I.target=Q.None,O&&k.value&&O.unobserve(k.value)}),Ct(async()=>{It.closeSplashscreen(),O=new IntersectionObserver(dt,{}),k.value&&O.observe(k.value),I.target=Q.ScriptList,await wt();const{controlDeviceInfo:e}=Tt();if(e.willRunScriptId){const t=T.value.findIndex(r=>r.id===e.willRunScriptId);t!==-1&&N(t)}}),(e,t)=>{const r=Ut,w=Dt,pt=Rt,ct=At,vt=Ot,ft=Yt;return E(),j("div",jt,[l(w,{modelValue:s(y).visible,"onUpdate:modelValue":t[0]||(t[0]=p=>s(y).visible=p),title:"脚本导入"},{footer:n(()=>[o("span",Jt,[l(r,{onClick:s(y).newImport},{default:n(()=>t[5]||(t[5]=[_("作为新脚本导入")])),_:1},8,["onClick"]),l(r,{onClick:s(y).updateImport},{default:n(()=>t[6]||(t[6]=[_("更新同名脚本")])),_:1},8,["onClick"])])]),default:n(()=>[o("div",null,R(s(y).content),1),t[7]||(t[7]=o("div",null,"作为新脚本导入：",-1)),t[8]||(t[8]=o("div",null," 此选项会在脚本列表新增一项脚本，该脚本无法继承同名脚本配置(id不一致) ",-1)),t[9]||(t[9]=o("div",null,"更新同名脚本：",-1)),t[10]||(t[10]=o("div",null," 此选项会将新脚本内容覆盖掉同名脚本，该脚本可以继承同名脚本配置(id一致) ",-1))]),_:1},8,["modelValue"]),l(w,{modelValue:s(v),"onUpdate:modelValue":t[2]||(t[2]=p=>Z(v)?v.value=p:null),title:"删除脚本"},{footer:n(()=>[o("span",Kt,[l(r,{onClick:t[1]||(t[1]=p=>v.value=!1)},{default:n(()=>t[11]||(t[11]=[_("取消")])),_:1}),l(r,{type:"danger",onClick:s(P)},{default:n(()=>t[12]||(t[12]=[_("删除")])),_:1},8,["onClick"])])]),default:n(()=>[t[13]||(t[13]=o("div",null,"确定要删除该脚本吗?",-1))]),_:1},8,["modelValue"]),o("div",{class:"header",ref_key:"headerRef",ref:k},[t[16]||(t[16]=o("span",{style:{"font-size":"18px"}},"脚本列表",-1)),o("div",Qt,[l(pt,{class:"input",id:"search_script_input",modelValue:s(I).content,"onUpdate:modelValue":t[3]||(t[3]=p=>s(I).content=p),clearable:"",placeholder:"搜索脚本名称或备注"},null,8,["modelValue"]),l(ct,null,{default:n(()=>[l(r,{onClick:M},{default:n(()=>t[14]||(t[14]=[_("导入")])),_:1}),l(r,{id:"new_script_btn",type:"primary",onClick:g},{default:n(()=>t[15]||(t[15]=[_("新建")])),_:1})]),_:1})])],512),o("div",Zt,[!s(G)&&s(T).length===0?(E(),H(vt,{key:0,description:"暂无脚本"})):xt("",!0),l(s($t),{ref_key:"el",ref:X,modelValue:s(U),"onUpdate:modelValue":t[4]||(t[4]=p=>Z(U)?U.value=p:null),ghostClass:"ghost",class:"draggable-content",disabled:s(ut),animation:200,handle:".drag-handle",onStart:W,onUpdate:B,onEnd:B},{default:n(()=>[(E(!0),j(Vt,null,ht(s(U),p=>(E(),H(ft,{key:p.id,id:p.id,onEditorScriptFile:m,"show-hover":s(A),onOpenFile:i,onSetScript:C,onRunScript:N,onDeleteScript:Y},null,8,["id","show-hover"]))),128))]),_:1},8,["modelValue","disabled"])])])}}}),le=rt(te,[["__scopeId","data-v-f8a93191"]]);export{le as default};
